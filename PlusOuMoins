#include <stdio.h>
#include <stdlib.h>
#include <time.h>
#include <stdbool.h>

int intInput() {
    int number;
    while (scanf("%d", &number) != 1) {
        printf("Veuillez saisir un entier valide : ");
        while (getchar() != '\n');
    }
    return number;
}

void borneMinMax(int* numberMin, int* numberMax) {
        printf("Entrez une valeur minimale : ");
        *numberMin = intInput();
        
        printf("Entrez une valeur maximale : ");
        *numberMax = intInput();
        
            while (*numberMin > *numberMax) {
                printf("La valeur minimale ne doit pas être supérieure à la valeur maximale. Veuillez réessayer.\n");
        
                printf("Entrez une nouvelle valeur minimale : ");
                *numberMin = intInput();
        
                printf("Entrez une nouvelle valeur maximale : ");
                *numberMax = intInput();
    } 
}

int intBorne(int numberMin, int numberMax) {
    int number;
    while (1) {
        number = intInput();
        if (number >= numberMin && number <= numberMax) {
            break;
        }
        printf("Veuillez saisir un entier entre %d et %d : ", numberMin, numberMax);
    }
    return number;
}

char inputChar() {
    char c;
    int iError = scanf(" %c", &c);

    if (iError == 0 || (c != 'y' && c != 'Y' && c != 'n' && c != 'N')) {
        printf("Veuillez saisir 'y', 'n', 'Y' ou 'N'.\n");
        return inputChar();
    } else {
        printf("Vous avez saisi %c\n", c);
        return c;
    }
}

int main() {
    srand(time(NULL));
    int numberMin, numberMax;
    char restart;
    bool play = true;

    while (play) {
        borneMinMax(&numberMin, &numberMax);

        int mysteryNumber = numberMin + rand() % (numberMax - numberMin + 1);
        int guessed = 1;
        int guessedNumber = 0;
        int* guessList = malloc(10 * sizeof(int));

        printf("Trouvez le nombre mystère entre %d et %d :\n", numberMin, numberMax);

        while (guessed <= 10) {
            printf("Entrez votre proposition : ");
            guessedNumber = intBorne(numberMin, numberMax);
            guessList[guessed - 1] = guessedNumber;

            if (guessedNumber == mysteryNumber) {
                printf("Félicitations, vous avez trouvé le nombre mystère en %d essais !\n", guessed);
                printf("Voici la liste des nombres que vous avez devinés :\n");
                
                for (int i = 0; i < guessed; i++) { // test tableau
                    printf("%d ", guessList[i]);
                }
                printf("\n");

                break;
                
            } else if (guessedNumber < mysteryNumber) {
                printf("Plus !\n");
                
            } else {
                printf("Moins !\n");
            }

            if (guessed >= 10) {
                printf("Vous avez dépassé le nombre d'essais autorisés. Le nombre mystère était : %d\n", mysteryNumber);
                printf("Voici la liste des nombres que vous avez devinés :\n");
                
                for (int i = 0; i < guessed; i++) { // test tableau
                    printf("%d ", guessList[i]);
                }
                printf("\n");

                break;
            }
            guessed++;
        }
        
        printf("Voulez-vous rejouer ? (y/n) : ");
        restart = inputChar();

        if (restart != 'y' && restart != 'Y') {
            play = false;
        }
    }

    return 0;
}

        // Lorsque la partie est terminée, afficher la liste de tous les nombres mystères devinés depuis le lancement du programme.
